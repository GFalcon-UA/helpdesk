<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      lang="en"
      ng-app="myApp">
<head>
    <meta charset="UTF-8">
    <title>Ticket overview</title>
</head>
<body>
<div ng-controller="TicketOverviewController as ctrl">
    <h1>Ticket - <span ng-bind="ctrl.ticket.name"></span></h1>
    Created on: <span ng-bind="ctrl.ticket.createdOn"></span></br>
    Status: <span ng-bind="ctrl.ticket.state"></span>  Category <span ng-bind="ctrl.ticket.category.name"></span></br>
    Urgency: <span ng-bind="ctrl.ticket.urgency"></span></br>
    Desired resolution date: <span ng-bind="ctrl.ticket.desiredDate"></span></br>
    Owner: <span ng-bind="ctrl.ticket.owner.firstName"></span></br>
    Approver: <span ng-bind="ctrl.ticket.approver.firstName"></span></br>
    Assignee: <span ng-bind="ctrl.ticket.assignee.firstName"></span></br>
    Attachments:
    <div>
        <table>
            <tr th:each="attachment: ${attachments}">
                <td th:text="${attachment.id}" />
                <a href="/" th:href="@{/ticketOverview/download}">Download</a>
                <!--<td><span ng-bind="attachment.content"></span></td>-->
            </tr>
        </table>
    <!--Attachments: <span ng-bind="ctrl.ticket.ticketAttachments"></span></br>-->
    </div>
    Description: <span ng-bind="ctrl.ticket.description"></span></br>
</div>

<div>
    <span><a href="/" th:href="@{/edit}">Edit ticket</a></span>
</div>

<div ng-controller="ShowHistoryController as hstr">
    <table>
        <thead>
        <tr>
            <th>Date</th>
            <th>User</th>
            <th>Action</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="history in hstr.histories">
            <td><span ng-bind="history.historyDate"></span></td>
            <td><span ng-bind="history.historyUser.firstName"></span></td>
            <td><span ng-bind="history.action"></span></td>
            <td><span ng-bind="history.description"></span></td>
        </tr>
        </tbody>
    </table>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.4/angular.js"></script>
<script type="text/javascript" th:src="@{/static/js/app.js}"></script>
<script type="text/javascript" th:src="@{/static/js/service/user_service.js}"></script>
<script type="text/javascript" th:src="@{/static/js/controller/ticket_overview_controller.js}"></script>
<script type="text/javascript" th:src="@{/static/js/controller/show_history_controller.js}"></script>

</body>
</html>